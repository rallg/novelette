%% This is file `novelette-headers.sty', part of `novelette' document class.
%% Copyright 2023 Robert Allgeyer.
%%
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, version 1.3c.
%%
%% ----------------------------------------------------------------------------
%% This file is loaded after fancyhdr package, and uses its syntax.
%% ----------------------------------------------------------------------------
%%
\ProvidesFile{novelette-headers.sty}%
[2023/09/24 v0.16 LaTeX file (header and footer styles).]
%%


%% This file is loaded AtEnd Preamble, when processing interior (not cover).


%%
\providecommand\headrulewidth{0pt}\renewcommand\headrulewidth{0pt}
\providecommand\footrulewidth{0pt}\renewcommand\footrulewidth{0pt}
\fancyhead[LO,RE,LE,RO,CE,CO]{}
\fancyfoot[LO,RE,LE,RO,CE,CO]{}
\def\headruleskip{0pt}
\def\footruleskip{0pt}
\def\headrulewidth{0pt}
\def\footrulewidth{0pt}
%%


%%
% Re-define \thispagestyle based on design. When it requests only the page
% number, decide based on this command and whether footer is used:
\fancypagestyle{footer}{\fancyhead[LO,RE,LE,RO,CE,CO]{}}
\fancypagestyle{plain}{\fancyhead[LO,RE,LE,RO,CE,CO]{}}
\fancypagestyle{fancyplain}{\fancyhead[LO,RE,LE,RO,CE,CO]{}}
%%


\def\hf@@font#1{#1}
\ifthenelse{\equal{\hf@font}{main}}{\def\hf@@font#1{\main{#1}}}{}
\ifthenelse{\equal{\hf@font}{sans}}{\def\hf@@font#1{\sans{#1}}}{}
\ifthenelse{\equal{\hf@font}{mono}}{\def\hf@@font#1{\mono{#1}}}{}
\ifthenelse{\equal{\hf@font}{alt}}{\def\hf@@font#1{\alt{#1}}}{}
\ifthenelse{\equal{\hf@font}{drama}}{\def\hf@@font#1{\drama{#1}}}{}
\ifthenelse{\equal{\hf@font}{deco}}{\def\hf@@font#1{\deco{#1}}}{}


%%
\def\nvt@headily#1{%
  \FPifeq{\hf@scale}{1}%
    \head@foottrue\rule{0pt}{\le@ding}{%
      \hf@@font{\addfontfeature{Ligatures=ResetAll,LetterSpace=4}#1}%
    }%
  \else%
    \head@foottrue\rule{0pt}{\le@ding}{%
      \hf@@font{\addfontfeature{ScaleAgain=\hf@scale,Ligatures=ResetAll,LetterSpace=4}#1}%
    }%
  \fi%
}
\def\nvt@widebar{%
  \rule[-\hf@scale\chars@dp]{.08em}{\hf@scale\chars@dp+\hf@scale\chars@ht}%
}
%%


%%
\def\p@genumber{%
  \FPifeq{\hf@scale}{1}%
    \strut\hf@@font{{\pn@ital{\pn@feat\thepage}}}%
  \else%
    \strut\hf@@font{{\pn@ital{\pn@feat\addfontfeature{ScaleAgain=\hf@scale}\thepage}}}%
  \fi%
}
%%


%%
\def\process@headfoot{ % Called AtEndPreamble.
  \ifthenelse{\equal{\@scheme}{1}}{
    \fancyfoot[CO,CE]{\raisebox{.02\type@size}{\nvt@headily{\p@genumber}}}
  }{}
  \ifthenelse{\equal{\@scheme}{2}}{
    \fancyhead[CE]{\nvt@headily{\nvt@versohead}}
    \fancyhead[CO]{\nvt@headily{\nvt@rectohead}}
    \fancyfoot[CO,CE]{\raisebox{.02\type@size}{\nvt@headily{\p@genumber}}}
  }{}
  \ifthenelse{\equal{\@scheme}{3}}{
    \fancyhead[LE]{\nvt@headily{\nvt@versohead}}
    \fancyhead[RO]{\nvt@headily{\nvt@rectohead}}
    \fancyfoot[LE,RO]{\raisebox{.02\type@size}{\nvt@headily{\p@genumber}}}
  }{}
  \ifthenelse{\equal{\@scheme}{4}}{
    \fancyhead[LE]{\nvt@headily{\p@genumber}}
    \fancyhead[RO]{\nvt@headily{\p@genumber}}
    \fancyhead[CE]{\nvt@headily{\nvt@versohead}}
    \fancyhead[CO]{\nvt@headily{\nvt@rectohead}}
  }{}
  \ifthenelse{\equal{\@scheme}{5}}{
    \fancyhead[LE]{\nvt@headily{\makebox[2\normalindent][l]{\p@genumber}\nvt@widebar}}
    \fancyhead[CE]{\nvt@headily{\nvt@versohead}}
    \fancyhead[CO]{\nvt@headily{\nvt@rectohead}}
    \fancyhead[RO]{\nvt@headily{\nvt@widebar\makebox[2\normalindent][r]{\p@genumber}}}
  }{}
  \ifthenelse{\equal{\@scheme}{6}}{
    \fancyhead[LE]{\nvt@headily{\p@genumber~/}}
    \fancyhead[CE]{\nvt@headily{\nvt@versohead}}
    \fancyhead[CO]{\nvt@headily{\nvt@rectohead}}
    \fancyhead[RO]{\nvt@headily{/~\p@genumber}}
  }{}
  \ifthenelse{\equal{\@scheme}{7}}{
    \fancyhead[CE]{\nvt@headily{\p@genumber~/~\nvt@versohead}}
    \fancyhead[CO]{\nvt@headily{\nvt@rectohead~/~\p@genumber}}
  }{}
  \pagestyle{fancy} % Unless over-ridden by \thispagestyle.
}
%%


%%
\endinput
%%
%% End of file `novelette-headers.sty'
