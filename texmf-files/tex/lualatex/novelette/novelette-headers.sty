%% This is file `novelette-headers.sty', part of `novelette' document class.
%% Copyright 2023 Robert Allgeyer.
%%
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, version 1.3c.
%%
\ProvidesFile{novelette-headers.sty}%
[2023/10/26 v0.21 LaTeX file (header and footer styles).]
%%


%% This file is loaded AtEndPreamble, when processing interior (not cover).
%% Looked at fancyhdr, decided it was simpler to do it directly.


%%
\newif\ifhead@foot % True inside header and footer.
\pagestyle{empty}
\def\main@pagestyle{empty}

%%
\def\wideb@r{\strut\char"2759}
\def\he@dily#1{\strut\raisebox{-.3\le@ding}{{\head@font#1}}}
\def\p@genumber{\strut{\head@font\pn@ital{\thepage}}}
%%

%% rph@l -> recto page header at left, etc.
\def\rph@l{} \def\rph@c{} \def\rph@r{} \def\vph@l{} \def\vph@c{} \def\vph@r{}
\def\rpf@l{} \def\rpf@c{} \def\rpf@r{} \def\vpf@l{} \def\vpf@c{} \def\vpf@r{}
%%

%%
\newcommand\page@head[3]{%
  \hbox to\textwidth{%
    \vbox to\headheight{%
      \hbox{%
        \rlap{\makebox[\textwidth][l]{\ignorespaces#1}}%
        \makebox[\textwidth][c]{\ignorespaces#2}%
        \llap{\makebox[\textwidth][r]{\ignorespaces#3}}%
      }%
    }%
  }%
}
%%

%%
\newcommand\page@foot[3]{%
  \hbox to\textwidth{%
    \vbox to\footskip{%
      \setlength\temp@l{\strut@dp+\f@gap\le@ding}%
      \vskip\temp@l%
      \hbox{%
        \rlap{\makebox[\textwidth][l]{\ignorespaces#1}}%
        \makebox[\textwidth][c]{\ignorespaces#2}%
        \llap{\makebox[\textwidth][r]{\ignorespaces#3}}%
      }%
    }%
  }%
}
%%


\def\ps@headfoot{
  \ps@empty
  \def\@oddhead{\page@head\rph@l\rph@c\rph@r}
  \def\@oddfoot{\page@foot\rpf@l\rpf@c\rpf@r}
  \def\@evenhead{\page@head\vph@l\vph@c\vph@r}
  \def\@evenfoot{\page@foot\vpf@l\vpf@c\vpf@r}
}

\def\ps@head{
  \ps@empty
  \def\@oddhead{\page@head\rph@l\rph@c\rph@r}
  \let\@oddfoot\@empty
  \def\@evenhead{\page@head\vph@l\vph@c\vph@r}
  \let\@evenfoot\@empty
}

\def\ps@foot{
  \ps@empty
  \let\@oddhead\@empty
  \def\@oddfoot{\page@foot\rpf@l\rpf@c\rpf@r}
  \let\@evenhead\@empty
  \def\@evenfoot{\page@foot\vpf@l\vpf@c\vpf@r}
}

\let\ps@plain\ps@foot\relax % Re-defined from LaTeX internal.

\newcommand\iffloatpage[2]{\if@fcolmade #1\else #2\fi}


%%
\def\process@headfoot{
  \ifthenelse{\equal{\@scheme}{1}}{
    \def\rpf@c{\p@genumber}
    \def\vpf@c{\p@genumber}
    \def\main@pagestyle{empty}
  }{}
  \ifthenelse{\equal{\@scheme}{2}}{
    \def\vph@c{\he@dily{\verso@head}}
    \def\rph@c{\he@dily{\recto@head}}
    \def\rpf@c{\p@genumber}
    \def\vpf@c{\p@genumber}
    \def\main@pagestyle{headfoot}
  }{}
  \ifthenelse{\equal{\@scheme}{3}}{
    \def\vph@l{\he@dily{\verso@head}}
    \def\rph@r{\he@dily{\recto@head}}
    \def\rpf@r{\p@genumber}
    \def\vpf@l{\p@genumber}
    \def\main@pagestyle{headfoot}
  }{}
  \ifthenelse{\equal{\@scheme}{4}}{
    \def\vph@l{\he@dily{\p@genumber}}
    \def\rph@r{\he@dily{\p@genumber}}
    \def\vph@c{\he@dily{\verso@head}}
    \def\rph@c{\he@dily{\recto@head}}
    \def\main@pagestyle{head}
  }{}
  \ifthenelse{\equal{\@scheme}{5}}{
    \def\vph@l{\he@dily{%
      \makebox[2\normalindent][l]{\p@genumber}\wideb@r}}
    \def\vph@c{\he@dily{\verso@head}}
    \def\rph@c{\he@dily{\recto@head}}
    \def\rph@r{\he@dily{%
      \wideb@r\makebox[2\normalindent][r]{\p@genumber}}}
    \def\main@pagestyle{head}
  }{}
  \ifthenelse{\equal{\@scheme}{6}}{
    \def\vph@l{\he@dily{\p@genumber~/}}
    \def\vph@c{\he@dily{\verso@head}}
    \def\rph@c{\he@dily{\recto@head}}
    \def\rph@r{\he@dily{/~\p@genumber}}
    \def\main@pagestyle{head}
  }{}
  \ifthenelse{\equal{\@scheme}{7}}{
    \def\vph@c{\he@dily{\p@genumber~/~\verso@head}}
    \def\rph@c{\he@dily{\recto@head~/~\p@genumber}}
    \main@pagestyle{head}
  }{}
}
%%


%%
\endinput
%%
%% End of file `novelette-headers.sty'
