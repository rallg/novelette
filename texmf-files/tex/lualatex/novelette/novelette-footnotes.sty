%% This is file `novelette-footnotes.sty', part of `novelette' document class.
%% Copyright 2023 Robert Allgeyer.
%%
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, version 1.3c.
%%
\ProvidesFile{novelette-footnotes.sty}%
[2023/10/26 v0.21 LaTeX file (commands for footnotes).]
%%


%% This file is loaded AtEndPreamble, when processing interior (not cover).


%% FOOTNOTES
%   Novelette does not enable numbered academic-style footnotes, which are
% intended for citation and documentation. Instead, Novelette allows literary
% style footnotes, which are usually brief remarks from the author to the
% reader. In this content, the remarks may be from a real or fictional author
% or editor, or even from a first-person character in the story.
%   Even the authoritative Chicago Manual of Style uses this format, when the
% footnote is a remark from its editors to the reader. Rare, but there.
%   The Swainson font has superscript symbolic markers, designed for this
% purpose: asterisk, dagger, daggerdbl, section. They are used instead of
% superscript numerals in the main text, with the ordinary characters
% (scaled to footnote size) at the footnote itself. Footnotes are not indented.
% If a footnote contains more than one paragraph, manually place indentation
% for the added paragraphs. The use of lengthy footnotes is discouraged.
%  If a footnote is written within an opening environment, it will have no
% marker in main text, and appear without marker below. This is standard.
% Such footnotes are intended to apply to the whole chapter, not a sentence.
%%


%% FOOTNOTE RULE (about 1/3 textwidth)
% Hacking: You may change .2\textwidth but not the kerns.
\def\footnoterule{\kern -3\p@ \hrule \@width .2\textwidth \kern 2.6\p@}
%%


%% REFERENCE MARKS
% \@makefnmark is an existing LaTeX macro, redefined here. Marker in main text.
% Swainson has superscript symbolic markers, designed for this purpose.
\newcounter{fnm@num} \setcounter{fnm@num}{1}
\newif\ifzm@rk % True for unmarked footnotes in openings.
\def\@makefnmark{\ifzm@rk\else\get@fnmark\fi}
\def\get@fnmark{% Places marker in the main text.
  \ifthenelse{\equal{\value{fnm@num}}{1}}{\gdef\fn@mark{*}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{2}}{\gdef\fn@mark{†}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{3}}{\gdef\fn@mark{‡}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{4}}{\gdef\fn@mark{§}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{5}}{\gdef\fn@mark{**}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{6}}{\gdef\fn@mark{††}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{7}}{\gdef\fn@mark{‡‡}}{}%
  \ifthenelse{\equal{\value{fnm@num}}{8}}{\gdef\fn@mark{§§}}{}%
  \sups{\fn@mark}%
}
\def\bfn@mark{% Bottom footnote marker.
  \fn@mark%
  \ifthenelse{\equal{\value{fnm@num}}{8}}%
    {\setcounter{fnm@num}{1}}%
    {\stepcounter{fnm@num}}%
}
%%


%% FOOTNOTE TEXT
% The actual footnote, at bottom of textblock, text in \@footnotesize.
\long\def\@footnotetext#1{%
  \begingroup%
  \footnote@font\alt@footnote@size%
  \insert\footins{%
    \interlinepenalty\interfootnotelinepenalty%
    \splittopskip%
    \footnotesep%
    \splitmaxdepth \dp\strutbox%
    \floatingpenalty \@MM%
    \hsize\columnwidth%
    \@parboxrestore%
    \def\@currentcounter{footnote}%
    \protected@edef\@currentlabel{\csname p@footnote\endcsname\@thefnmark}%
    \setlength\parindent{0pt}%
    \leavevmode\ignorespaces\rule{0pt}{.88\strut@ht}%
    \ifzm@rk\else\bfn@mark\,\fi#1\rule[-.88\strut@dp]{0pt}{.88\strut@dp}%
  }%
  \endgroup%
}
%%


%% Pertains to some standard LaTeX footnote code:
\AtBeginShipout{\gdef\@fnafter{}}
%%


%%
\endinput
%%
%% End of file `novelette-footnotes.sty'.
